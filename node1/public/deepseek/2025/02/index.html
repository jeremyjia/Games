<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025/02</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .nav-menu {
            background: #333;
            font-family: Arial, sans-serif;
        }

        .menu-items {
            display: flex;
            list-style: none;
            flex-wrap: wrap;
        }

        .menu-item {
            position: relative;
            text-align: center;
        }

        .menu-item a {
            display: block;
            padding: 1rem;
            color: white;
            text-decoration: none;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .submenu {
            display: none;
            position: absolute;
            background: #444;
            min-width: 200px;
            top: 100%;
            left: 0;
        }

        .menu-item:hover .submenu {
            display: block;
        }

        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            padding: 1rem;
            cursor: pointer;
        }

        @media (max-width: 400px) {
            .menu-item {
                width: 33.33%;
                border: 1px solid #555;
            }
            
            .menu-item:nth-child(n+4) {
                width: 25%;  /* 修改为25%宽度 */
                font-size: 0.7rem;  /* 微调字体大小 */
            }

            .submenu {
                position: static;
                width: 100%;
                background: #666;
            }

            .menu-item.active .submenu {
                display: block;
                width: 100vw;
                margin-left: -1rem;
            }

            .mobile-menu-toggle {
                display: block;
            }
        }
    </style>
</head>
<body>
    <nav class="nav-container"></nav>
    <p>第二行开始显示四项菜单项。</p>
    <script>
        class NavMenu {
            constructor(config) {
                // 使用深拷贝避免污染原始配置
                this.config = JSON.parse(JSON.stringify(config));
                this.config.items[2].children = [
                    { 
                        text: '深度求索', 
                        href: 'https://www.deepseek.com', 
                        title: '前往深度求索主页' 
                    }
                ];
                this.init();
                this.bindEvents();
                this.handleResize();
            }

            init() {
                this.nav = document.createElement('nav');
                this.nav.className = 'nav-menu';
                
                this.toggleButton = document.createElement('button');
                this.toggleButton.className = 'mobile-menu-toggle';
                this.toggleButton.innerHTML = '☰';
                
                this.menuItems = document.createElement('ul');
                this.menuItems.className = 'menu-items';
                
                this.config.items.forEach(item => {
                    this.menuItems.appendChild(this.createMenuItem(item));
                });

                this.nav.appendChild(this.toggleButton);
                this.nav.appendChild(this.menuItems);
            }

            createMenuItem(item) {
                const li = document.createElement('li');
                li.className = 'menu-item';
                
                const a = document.createElement('a');
                a.href = item.href || '#';  // 安全处理href
                a.textContent = item.text;
                if (item.title) a.title = item.title;

                li.appendChild(a);

                if (item.children) {
                    const submenu = document.createElement('ul');
                    submenu.className = 'submenu';
                    item.children.forEach(child => {
                        submenu.appendChild(this.createMenuItem(child));
                    });
                    li.appendChild(submenu);
                }

                return li;
            }

            bindEvents() {
                // 菜单切换按钮事件
                this.toggleButton.addEventListener('click', () => {
                    this.menuItems.style.display = this.menuItems.style.display === 'none' 
                        ? 'flex' 
                        : 'none';
                });

                // 子菜单交互逻辑
                this.menuItems.querySelectorAll('.menu-item').forEach(item => {
                    const submenu = item.querySelector('.submenu');
                    if (!submenu) return;

                    item.addEventListener('click', (e) => {
                        if (window.innerWidth > 400) return;
                        
                        e.preventDefault();  // 阻止默认行为
                        e.stopPropagation();
                        item.classList.toggle('active');
                    });
                });

                // 点击外部区域关闭菜单
                window.addEventListener('click', () => {
                    if (window.innerWidth <= 400) {
                        this.menuItems.querySelectorAll('.menu-item').forEach(item => {
                            item.classList.remove('active');
                        });
                    }
                });

                // 响应式处理
                window.addEventListener('resize', () => this.handleResize());
            }

            handleResize() {
                if (window.innerWidth > 400) {
                    this.menuItems.style.display = 'flex';
                    this.menuItems.querySelectorAll('.submenu').forEach(sub => {
                        sub.style.display = '';
                    });
                } else {
                    this.menuItems.style.display = 'none';
                }
            }
        }

        // 初始化配置
        const menuConfig = {
            items: [
                { text: '首页', href: '/' },
                { text: '[..]', href: '..' },
                { text: '[2025/02]->', href: '#' },
                { text: '[03]', href: '03' },
                { text: '[04]', href: '04' },
                { text: '[08]', href: '08' },
                { text: '[10]', href: '10' },
                { text: '[11]', href: '11' },
                { text: '[12]', href: '12' },
                { text: '[13]', href: '13' },
                { text: '[14]', href: '14' },
                { text: '[15]', href: '15' },
                { text: '[16]', href: '16' }
            ]
        };

        const nav = new NavMenu(menuConfig);
        nav.toggleButton.click();
        document.querySelector('.nav-container').appendChild(nav.nav);
    </script>
</body>
</html>