<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Diff Tool</title>
    <style>
        textarea { width: 100%; height: 100px; }
        .diff { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Text Diff Tool</h1>
    <textarea id="text1" placeholder="Enter first text"></textarea>
    <textarea id="text2" placeholder="Enter second text"></textarea>
    <button onclick="compareTexts()">Compare Texts</button>
    <button onclick="generateDoc()">Generate Word Document</button>
    <div class="diff" id="diffResult"></div>
    <a id="downloadLink" style="display:none;" href=" ">Download Word Document</a >

    <script>
        async function compareTexts() {
            const text1 = document.getElementById('text1').value;
            const text2 = document.getElementById('text2').value;

            const response = await fetch('/compare', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text1, text2 })
            });

            const { differences } = await response.json();
            const diffResult = document.getElementById('diffResult');
            diffResult.innerHTML = differences.map(diff => 
                `<span style="color: ${diff.added ? 'green' : diff.removed ? 'red' : 'black'}">${diff.value}</span>`
            ).join('');
        }

        async function generateDoc() {
            const text1 = document.getElementById('text1').value;
            const text2 = document.getElementById('text2').value;

            const response = await fetch('/compare', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text1, text2 })
            });

            const { differences } = await response.json();

            const docResponse = await fetch('/generate-doc', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ differences })
            });

            const { filePath } = await docResponse.json();
            const downloadLink = document.getElementById('downloadLink');
            downloadLink.href = filePath;
            downloadLink.style.display = 'block';
        }
    </script>
</body>
</html>