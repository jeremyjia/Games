<!DOCTYPE html>
<html>
<head>
    <style>
        .lyrics-container {
            font-size: 48px;
            font-weight: bold;
            text-align: center;
            border: #666 solid 1px;
            margin: 50px;
        }
        
        .lyrics-text span {
            color: #666;  /* 默认颜色 */
            transition: color 1.3s ease;  /* 添加颜色过渡效果 */
            border: #66f solid 1px;
        }
        
        .lyrics-text span.active {
            color: #ff00ff;  /* 高亮颜色 */
        }
        .xdTest span {
            color: #a66;  /* 默认颜色 */
            transition: color 1.3s ease;  /* 添加颜色过渡效果 */
            border: #66f solid 1px;
            background-color: #666;
            width: 40px;
            top: 333px;
            left: 50px;
            position: absolute;
        }
        .xdTest span.green {
            color: #ffffff;  /* 高亮颜色 */
            background-color: #00ff00;
        }
        .xdTest span.blue {
            background-color: #0000ff;
            color: #ffffff;  /* 高亮颜色 */
        }
        .timerStick { 
            position: absolute;
            width: 2px;
            top: 233px;
            left: 50px;
            border: #11f solid 1px;
        }
    </style>
</head>
<body>
    from deepseek. 2025.1.29 Wed Beijing.

    <div class="lyrics-container">
        <div class="lyrics-text" id="lyrics"></div>
        <div class="xdTest" id="id4Test"></div>
        
        <div class = "timerStick"  id="id4Stick">movestick</div>
        <div class="toolbar" id="id4Toolbar">
            <button id="id4btnStart">start</button>
        </div>
    </div>

    <script>
        // 初始化 id4Test
        function initTest() { 
            const btnStart = document.getElementById("id4btnStart"); 
            const dStick = document.getElementById("id4Stick"); 
            dStick.toMove = function(me,myTimer){
                me.innerHTML = myTimer.getStep();  
                myTimer.moveObj(me);
            }
            btnStart.onclick = function(){
                musicTimer.clickTimer(btnStart,dStick);
                const lyricsText = "1111222233334444";
                const lyricsElement = document.getElementById("id4Test");
                
                // 将每个字符用span包裹
                lyricsElement.innerHTML = lyricsText.split('').map(char => 
                    `<span>${char}</span>`
                ).join('');
                const spans = document.querySelectorAll("#id4Test span");
                
                spans.forEach((span, index) => { 
                        span.style.left = (50 + index*40) + 'px'; 
                });

                startXD();
            }
        }
        // xd启动动画
        function startXD() {
            const spans = document.querySelectorAll("#id4Test span");
            
            spans.forEach((span, index) => {
                // 为每个字符设置延迟动画
                setTimeout(() => {  
                    span.style.left = (50 + index*40) + 'px';
                    span.classList.add("blue"); 
                }, index*300);  // 每个字符间隔300ms
            });
        }
        // 初始化歌词
        function initLyrics() {
            const lyricsText = "轻轻敲醒沉睡的心灵";
            const lyricsElement = document.getElementById("lyrics");
            
            // 将每个字符用span包裹
            lyricsElement.innerHTML = lyricsText.split('').map(char => 
                `<span>${char}</span>`
            ).join('');
        }

        // 启动动画
        function startKaraoke() {
            const spans = document.querySelectorAll("#lyrics span");
            
            spans.forEach((span, index) => {
                // 为每个字符设置延迟动画
                setTimeout(() => {
                    span.classList.add("active");
                }, index * 300);  // 每个字符间隔300ms
            });
        }

        // 初始化并启动
        initTest(); 
        initLyrics();
        startKaraoke();
        const musicTimer = function(){ 
            let o = {};
            o.id = "1234";
            o.clickTimer = function(btnTimer,moveStick){
                if(!bIsRunning) {
                    toRun(moveStick,100);
                    btnTimer.innerHTML = "stop";
                    nStep = 0;
                }
                else{
                    btnTimer.innerHTML = "start";
                }
                bIsRunning = !bIsRunning; 
            }
            o.getStep = function(){ return nStep;}
            o.moveObj = function(oDiv){
                oDiv.style.left = (50 + nStep*4) + 'px';
            }
            
            let toRun = function(moveStick,nTimeout){
                nStep++;
                setTimeout(() => {
                    if(moveStick.toMove) moveStick.toMove(moveStick,o);
                    if(bIsRunning) toRun(moveStick,nTimeout);
                }, nTimeout); 
            }

            let nStep = 0;
            let bIsRunning = false;
            return o;      
        }();
    </script>
</body>
</html>